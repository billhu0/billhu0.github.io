<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Bill Hu"><meta name="keywords" content=""><meta name="description" content="Never do &#39;sudo rm -rf &#x2F;&#39;"><meta property="og:type" content="article"><meta property="og:title" content="Some Linux shell commands"><meta property="og:url" content="https://www.billhu.us/2022/19_linux_commands/index.html"><meta property="og:site_name" content="Bill Hu&#39;s Blog"><meta property="og:description" content="Never do &#39;sudo rm -rf &#x2F;&#39;"><meta property="og:locale" content="en_US"><meta property="article:published_time" content="2022-02-10T18:21:19.000Z"><meta property="article:modified_time" content="2024-07-12T16:15:23.742Z"><meta property="article:author" content="Bill Hu"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary_large_image"><title>Some Linux shell commands - Bill Hu&#39;s Blog</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><link rel="stylesheet" href="/css/myfont.css"><link rel="stylesheet" href="/css/jetbrains-mono.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"www.billhu.us",root:"/",version:"1.9.7",typing:{enable:!0,typeSpeed:25,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:3},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},gtag:null},search_path:"/local-search.xml",include_content_in_search:!0});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script>!function(t,e,n,c,a,r){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(a=e.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/fjnxcr4gva",(r=e.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script><meta name="google-site-verification" content="IqNfw3GiMxuhw7kYoEdhMJoh3j99KHuGI9bw00hPn2c"><link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet"><meta name="generator" content="Hexo 7.1.1"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Bill Hu&#39;s Blog</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>Home</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>Archives</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>Categories</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/" target="_self"><i class="iconfont icon-tags-fill"></i> <span>Tags</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>About</span></a></li><li class="nav-item"><a class="nav-link" href="https://about.billhu.us" target="_self"><i class="iconfont icon-code"></i> <span>Portfolio</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="Some Linux shell commands"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-02-10 18:21" pubdate>February 10, 2022 pm</time></span></div><div class="mt-1"></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header">Some Linux shell commands</h1><div class="markdown-body"><div class="note note-danger"><p>Some linux commands listed here are only available on Ubuntu/Debian. Other linux distributions may have differences.</p></div><h1 id="symbols"><a class="markdownIt-Anchor" href="#symbols"></a> <code>|</code> <code>||</code> <code>&amp;&amp;</code> symbols</h1><ul><li><code>&amp;&amp;</code>: do the latter command only if the former command succeeds. E.g. <code>echo 1 &amp;&amp; echo &quot;success&quot;</code></li><li><code>||</code>: do the latter command only if the former command fails. E.g. <code>cat xxx || echo &quot;fail&quot;</code></li><li>The above two symbols can appear in one sentence, like <code>&#123;do something&#125; &amp;&amp; &#123;echo &quot;success&quot;&#125; || &#123;echo &quot;fail&quot;&#125;</code></li><li><code>|</code> denotes a ‘pipe’ command. It lets you use 2 or more commands s.t. the output of one command serves as input to the next.<ul><li><code>|</code> can only handle <code>stdout</code> from the last command. It cannot handle <code>stderr</code> directly. If you want to make <code>stderr</code> available for the pipe, redirect the data stream by using <code>2&gt;&amp;1</code>.</li><li>The latter command (followed by <code>|</code>) must be able to handle inputs from <code>stdin</code>. For example, <code>ls</code>, <code>cp</code>, <code>mv</code> does not accept datas from <code>stdin</code> and they are not pipe commands.</li><li>E.g. <code>ifconfig | grep inet</code></li></ul></li></ul><h1 id="-related-symbols"><a class="markdownIt-Anchor" href="#-related-symbols"></a> <code>$</code>-related symbols</h1><h3 id="variables"><a class="markdownIt-Anchor" href="#variables"></a> Variables</h3><ul><li><code>$xxx</code> or <code>$&#123;xxx&#125;</code> fetches the value of a variable or the environment variable</li></ul><h3 id="calculate-the-result"><a class="markdownIt-Anchor" href="#calculate-the-result"></a> Calculate the result</h3><ul><li><p><code>$( )</code> and <code>``</code> (back quote) executes the command inside the bracket or back quote, and returns the output of that command</p></li><li><p><code>$(( ))</code> <code>$[]</code> calculates the formula</p></li></ul><h3 id="others"><a class="markdownIt-Anchor" href="#others"></a> Others</h3><ul><li><code>$#</code> indicates ‘argc’, the count of arguments</li><li><code>$n</code> is the value of the n-th argument, where n=1,2,…,9</li><li><code>$*</code> shows all arguments’ value (can exceed 9) in a single string</li><li><code>$@</code> is almost the same as <code>$*</code>, except that <code>$@</code> will add quotation marks to pass multiple arguments, unlike <code>$*</code> which combines all arguments into one single argument</li><li><code>$$</code> is the PID (Process ID) of the shell itself</li><li><code>$?</code> is the return value of the last command, where <code>0</code> indicates success, and all other values means an error</li><li><code>$!</code> is the PID of the last background command (the last background process)</li></ul><h1 id="dpkg"><a class="markdownIt-Anchor" href="#dpkg"></a> <code>dpkg</code></h1><ul><li>Install <code>deb</code> type softwares on Ubuntu or Debian: <code>sudo dpkg -i xxx.deb</code></li></ul><h1 id="scp-commands"><a class="markdownIt-Anchor" href="#scp-commands"></a> <code>scp</code> Commands</h1><p><code>scp</code> command can be used to copy files between local and remote, which is based on <code>ssh</code> protocal.</p><h2 id="copy-local-files-to-a-remote-host"><a class="markdownIt-Anchor" href="#copy-local-files-to-a-remote-host"></a> Copy local files to a remote host</h2><h3 id="copy-files"><a class="markdownIt-Anchor" href="#copy-files"></a> Copy file(s)</h3><ul><li>Copy local files to remote host’s specified directory (the file name keeps same)</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp path/to/local/file RemoteUsrName@IP:/path/to/remote/folder/<br></code></pre></td></tr></table></figure><ul><li>Specify the file name, and rename the file to specified filename when copying</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp path/to/local/file RemoteUsrName@IP:/path/to/remote/file<br></code></pre></td></tr></table></figure><h3 id="copy-directory"><a class="markdownIt-Anchor" href="#copy-directory"></a> Copy directory</h3><ul><li>Copy a directory, but hidden files (such as <code>.git</code> directory) will not be copied</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp -r /path/to/local/folder RemoteUsrName@IP:/path/to/remote/folder/<br></code></pre></td></tr></table></figure><ul><li>Copy a directory, including all hidden directories</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp -rp /path/to/local/folder RemoteUsrName@IP:/path/to/remote/folder/<br></code></pre></td></tr></table></figure><h2 id="download-remote-files-to-local-directory"><a class="markdownIt-Anchor" href="#download-remote-files-to-local-directory"></a> Download remote files to local directory</h2><p>To download files, we only need to swap the last two arguments (file or directory path) in the commands. For example:</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">scp -rp RemoteUsrName@IP:/path/to/remote/folder/  /path/to/local/folder`<br></code></pre></td></tr></table></figure><div class="note note-info"><p><code>scp</code> uses the same protocal as <code>ssh</code>, and will also use port <code>22</code> by default.</p><p>If you want to use another port, you need to add <code>-P xxx</code> after <code>scp</code> command, for instance, <code>scp -P 10000 -rp /path/to/local/folder RemoteUsrName@IP:/path/to/remote/folder/</code>. Note that you have to use uppercase <code>P</code></p></div><div class="note note-success"><p>Want to avoid typing password everytime you use <code>scp</code>? You need to configure public key authentication for ssh. For reference, <a href="/2022/14_ssh_keygen/" title="ssh-keygen 是什么？">ssh-keygen 是什么？</a></p></div><h1 id="view-and-change-hostname"><a class="markdownIt-Anchor" href="#view-and-change-hostname"></a> View and change hostname</h1><ul><li><p>See your hostname on Ubuntu: use <code>hostname</code> command or <code>uname -n</code> command</p></li><li><p>Change your hostname on Ubuntu:</p><ul><li><p><code>sudo vim /etc/hostname</code> to change the hostname forever (Restart to take effect)</p></li><li><p><code>hostname xxx</code> to change the hostname temporarily (takes effect immediately, but restart will restore the original hostname)</p></li></ul></li></ul><h1 id="modify-the-prompt-after-a-successful-login"><a class="markdownIt-Anchor" href="#modify-the-prompt-after-a-successful-login"></a> Modify the prompt after a successful login</h1><ul><li><p>Ubuntu： <code>cd /etc/update-motd.d</code> and modify the shell scripts inside it.</p><p>(You may add <code>exit 0</code> command near the beginning of the scripts, to ‘cancel’ executing it by letting it exit earlier)</p></li></ul><h1 id="cannot-ssh-to-your-machine"><a class="markdownIt-Anchor" href="#cannot-ssh-to-your-machine"></a> Cannot SSH to your machine?</h1><p>If you cannot ssh to your machine remotely, check these settings:</p><ul><li>Check whether <code>openssh-server</code> is installed</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo apt install openssh-server<br></code></pre></td></tr></table></figure><ul><li>ufw</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo ufw disable<br></code></pre></td></tr></table></figure><ul><li><p>Modify your sshd configuration</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo vim <span class="hljs-regexp">/etc/</span>ssh/sshd_config<br></code></pre></td></tr></table></figure><p>To allow SSH to <code>root</code> user, set the following config in the file</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">PermitRootLogin prohibit-password  # <span class="hljs-built_in">disable</span> this<br>PermitRootLogin <span class="hljs-literal">yes</span>   # <span class="hljs-built_in">enable</span> this<br></code></pre></td></tr></table></figure></li><li><p>Restart SSH service</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo service ssh restart<br></code></pre></td></tr></table></figure></li></ul><h1 id="terminal-timeout-with-ssh"><a class="markdownIt-Anchor" href="#terminal-timeout-with-ssh"></a> Terminal timeout with SSH?</h1><p>It is sometimes annoying that, when SSHing to a remote machine, the session gets timeout after minutes of inactivity, and you have to reinitiate the connection. Well, this can be solved under a simple fix.</p><p>On the local machine, open <code>~/.ssh/config</code> and add the following line:</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Host</span> *<br>    <span class="hljs-attribute">ServerAliveInterval</span> <span class="hljs-number">60</span><br></code></pre></td></tr></table></figure><p>The meaning is, for any remote host, send a null packet every 60 seconds to keep the connection alive.</p><p>The alternative is to configure on remote host. On the server, edit the <code>/etc/ssh/sshd_config</code> file, and find the following parameters: <code>ClientAliveInterval</code> and <code>ClientAliveCountMax</code>.</p><ul><li><p><code>ClientAliveInterval</code> specifies the time (in seconds) that the server will wait before sending a null packet to client to keep connection alive.</p></li><li><p><code>ClientAliveCountMax</code> defines the number of client alive messages which are sent without getting any msg from the client. When this limit is reached, the remote host will drop this connection to terminate this SSH session.</p></li></ul><p>For instance, you can set</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ClientAliveInterval</span> <span class="hljs-number">1200</span><br><span class="hljs-attribute">ClientAliveCountMax</span> <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>The timeout value is given by the product of the two parameters.<br>(timeoutvalue = <code>ClientAliveInterval</code> * <code>ClientAliveCountMax</code>)</p><p>After that, reload OpenSSH-server service.</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo systemctl reload sshd<br></code></pre></td></tr></table></figure><h1 id="how-to-add-a-user"><a class="markdownIt-Anchor" href="#how-to-add-a-user"></a> How to add a user?</h1><p>First we need to know the difference between <code>adduser</code> and <code>useradd</code>.</p><p>Both commands are used for creating a new user, but follow different ways to execute it.</p><p>The main difference is that,</p><ul><li><code>adduser</code> will setup the user’s home folder, password and other necessary functions, asking you to fill up the information.</li><li><code>useradd</code> only creates a new user, without creating the home directory, adding password and so on.</li></ul><div class="note note-info"><p>For beginners, it is highly recommended to use <strong><code>adduser</code></strong> command.</p></div><p>Only <code>root</code> user is allowed to add or modify users. If you are a normal user, you need to use <code>sudo adduser</code> to add a user.</p><h2 id="how-to-add-a-user-to-sudoers"><a class="markdownIt-Anchor" href="#how-to-add-a-user-to-sudoers"></a> How to add a user to sudoers</h2><p>There’re two ways to grant sudo privileges to a user. The recommended one is to add the user to sudo group. An alternative is to edit the sudoers file.</p><h3 id="add-the-user-to-sudo-group"><a class="markdownIt-Anchor" href="#add-the-user-to-sudo-group"></a> Add the user to <code>sudo</code> group</h3><p>The easiest way to grant sudo privileges to a user is by adding it to the ‘sudo’ group. Members in this group can execute any command as ‘root’ via <code>sudo</code>.</p><div class="note note-info"><p>A 'group' refers to a collection of users who are given a similar permissions. Note that one user may belong to multiple groups.</p></div><p>To add a user to ‘sudo’ group, use the following command (replace <code>USERNAME</code> with the username you want to grant sudo access):</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">usermod -aG sudo USERNAME<br></code></pre></td></tr></table></figure><p>To ensure you have successfully granted the user sudo privileges, use <code>sudo whoami</code> and see the output. If the output is ‘root’, you succeeds.</p><h3 id="add-the-user-to-sudoers-file"><a class="markdownIt-Anchor" href="#add-the-user-to-sudoers-file"></a> Add the user to <code>sudoers</code> file</h3><p>This way is not recommended compared to the above one.</p><p>The users’ and groups’ sudo privileges configurations are stored in <code>/etc/sudoers</code> file. You can configure the sudo access by modifying theis file, or by creating a new configuration file in <code>/etc/sudoers.d/</code> directory, since the files in this dir are included in the sudoers file.</p><div class="note note-danger"><p>You should <strong>always use <code>visudo</code> command</strong> to edit the sudoers file. This command will check for syntax errors when you save it. If an error is detected, the file is not saved to prevent unexpected disaters.</p></div><p>Open the file by <code>visudo /etc/sudoers</code> and add the following line at the end of the file (change ‘USERNAME’ with the username you want to grant access to)</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">USERNAME <span class="hljs-keyword">ALL</span>=(<span class="hljs-keyword">ALL</span>:<span class="hljs-keyword">ALL</span>) NOPASSWD: <span class="hljs-keyword">ALL</span><br></code></pre></td></tr></table></figure><p>This grants the user permission to execute all commands via sudo. If you want to give partial permissions only, consider this example:</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">USERNAME <span class="hljs-built_in">ALL</span>=(<span class="hljs-built_in">ALL</span>:<span class="hljs-built_in">ALL</span>) NOPASSWD: <span class="hljs-regexp">/bin/</span>rm, /bin/mkdir<br></code></pre></td></tr></table></figure><p>This allows only <code>mkdir</code> and <code>rm</code> commands to be run as root, which is safer under some special circumstances.</p><h1 id="create-a-service-and-autostart"><a class="markdownIt-Anchor" href="#create-a-service-and-autostart"></a> Create a service and autostart</h1><p>Some tasks requires the terminal to be active all the times. When a terminal window is closed, the process inside it might stop. You can use <code>screen</code> to make something always alive in the terminal, however it cannot autostart at system startup. To configure the autostart, we need to create a ‘service’.</p><p>In <code>/lib/systemd/system/</code>, create a file named <code>xxx.service</code> (you may need <code>sudo</code>), and write the following things:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Unit]</span><br><span class="hljs-attr">Description</span>=Write your description here<br><br><span class="hljs-section">[Service]</span><br><span class="hljs-attr">Type</span>=simple<br><span class="hljs-attr">User</span>=your_username<br><span class="hljs-attr">Group</span>=your_users_group_name<br><span class="hljs-attr">ExecStart</span>=Enter_your_command_here<br><br><span class="hljs-section">[Install]</span><br><span class="hljs-attr">WantedBy</span>=multi-user.target<br></code></pre></td></tr></table></figure><div class="note note-info"><p>Without the line <code>User=xxx</code> and <code>Group=xxx</code>, the service will run as root by default.</p></div><p>Then you can start this service, and it will be running in the background</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">sudo systemctl <span class="hljs-literal">start</span> xxx<br></code></pre></td></tr></table></figure><p>To make it start automatically at system startup, enter</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo systemctl <span class="hljs-built_in">enable</span> xxx<br></code></pre></td></tr></table></figure><p>At any time, to check the service status and its output, use</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo systemctl status xxx</span><br></code></pre></td></tr></table></figure><h1 id="let-nginx-reverse-proxy-code-server"><a class="markdownIt-Anchor" href="#let-nginx-reverse-proxy-code-server"></a> Let nginx reverse proxy ‘code-server’</h1><p>Suppose your code-server (VSCode on the web) is running on <code>localhost:12345</code>. Then, to proxy it, add the following to your nginx configuation</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">server</span> &#123;<br>    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>; <br>    <span class="hljs-attribute">server_name</span> domain.name.com;   <span class="hljs-comment"># replace with your domain name</span><br>    <span class="hljs-section">location</span> / &#123;<br>        <span class="hljs-attribute">proxy_pass</span>  http://localhost:12345;   <span class="hljs-comment"># enter your localhost address and port here</span><br>        <span class="hljs-attribute">proxy_redirect</span>     <span class="hljs-literal">off</span>;<br>        <span class="hljs-attribute">proxy_set_header</span>   Host             <span class="hljs-variable">$host</span>;        <br>        <span class="hljs-attribute">proxy_set_header</span>   X-Real-IP        <span class="hljs-variable">$remote_addr</span>;  <br>        <span class="hljs-attribute">proxy_set_header</span>   X-Scheme         <span class="hljs-variable">$scheme</span>;       <br>        <span class="hljs-attribute">proxy_set_header</span>   X-Forwarded-For  <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;<br>        <span class="hljs-attribute">proxy_set_header</span>   Accept-Encoding  gzip;<br>        <span class="hljs-attribute">proxy_set_header</span>   Upgrade          <span class="hljs-variable">$http_upgrade</span>;<br>        <span class="hljs-attribute">proxy_set_header</span>   Connection       upgrade; <br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="use-sudo-without-password"><a class="markdownIt-Anchor" href="#use-sudo-without-password"></a> Use sudo without password</h1><p>To use <code>sudo</code> without password, we need to configure <code>/etc/sudoers</code> file.</p><p>It’s recommended to use <code>visudo</code> command to edit it, instead of using normal editors like <code>vim</code>.</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">visudo</span><br></code></pre></td></tr></table></figure><p>and in the end of this file, add a line</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">&lt;your_username&gt;  <span class="hljs-keyword">ALL</span>=(<span class="hljs-keyword">ALL</span>:<span class="hljs-keyword">ALL</span>) NOPASSWD: <span class="hljs-keyword">ALL</span><br></code></pre></td></tr></table></figure><p>After that, save the file.</p><div class="note note-info"><p>The default editor for <code>root</code> user might be <code>nano</code>. If you prefer <code>vim</code>, you can switch to the root user (<code>sudo -i</code>), and add a line <code>export EDITOR=/usr/bin/vim</code> in <code>/root/.bashrc</code> to let <code>vim</code> be the default editor.</p></div><h1 id="clean-up-journal-log-files-to-save-disk-space"><a class="markdownIt-Anchor" href="#clean-up-journal-log-files-to-save-disk-space"></a> Clean up journal (log files) to save disk space</h1><p>You may find that <code>/var/log/journal/</code> occpies a large amount of your disk usage. These are log files created by ‘journal’ service (systemd), and can be disabled or limited to save space.</p><p>To limit its storage, use</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo <span class="hljs-keyword">journalctl </span>--<span class="hljs-keyword">disk-usage </span>     <span class="hljs-comment"># see the disk usage</span><br>sudo <span class="hljs-keyword">journalctl </span>--vacuum-time=<span class="hljs-number">1</span>d  <span class="hljs-comment"># remove logs more than 1 day ago</span><br>sudo <span class="hljs-keyword">journalctl </span>--vacuum-size=<span class="hljs-number">10</span>M <span class="hljs-comment"># limit every log&#x27;s size to 10MB</span><br></code></pre></td></tr></table></figure><p>After that, your <code>/var/log/journal/</code> space will be significantly reduced</p></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Linux/" class="category-chain-item">Linux</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Linux/" class="print-no-link">#Linux</a></div></div><div class="license-box my-3"><div class="license-title"><div>Some Linux shell commands</div><div>https://www.billhu.us/2022/19_linux_commands/</div></div><div class="license-meta"><div class="license-meta-item"><div>Author</div><div>Bill Hu</div></div><div class="license-meta-item license-meta-date"><div>Posted on</div><div>February 10, 2022</div></div><div class="license-meta-item"><div>Licensed under</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2022/18_ubt_swap/" title="How to configure swap on Ubuntu"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">How to configure swap on Ubuntu</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/2022/16_frp/" title="(macOS/Linux/Windows) How to use frp for NAT-penetration"><span class="hidden-mobile">(macOS/Linux/Windows) How to use frp for NAT-penetration</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <span>With </span><a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <i class="iconfont icon-love"></i> <a href="/about" target="_blank" rel="nofollow noopener"><span>Bill Hu</span></a><div style="font-size:.85rem"><span id="timeDate">Loading days...</span> <span id="times">Loading time...</span><script src="/js/duration.min.js"></script></div></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>